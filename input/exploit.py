import os
import socket as sock
import time

argv = ["0" for i in range(100)]
argv[0x41] = ""
argv[0x42] = "\x20\x0a\x0d"
argv[0x43] = "8200"
argv[0] = "/home/x4d5a/pwnable.kr/input/input"

os.putenv(b"\xde\xad\xbe\xef", b"\xca\xfe\xba\xbe")

with open("\x0a", "wb") as f:
	f.write(b"\x00\x00\x00\x00")

stdin = os.pipe()
stderr = os.pipe()
cpid = os.fork()
if 0 == cpid:
	os.dup2(stdin[0],0)
	os.dup2(stderr[0],2)
	os.execv("/home/x4d5a/pwnable.kr/input/input", argv)
else:
	os.write(stdin[1], b"\x00\x0a\x00\xff")
	os.write(stderr[1], b"\x00\x0a\x02\xff")

	time.sleep(1)
	with sock.socket(sock.AF_INET, sock.SOCK_STREAM, 0) as s:
		s.connect(("127.0.0.1", 8200))
		s.send(b"\xde\xad\xbe\xef")

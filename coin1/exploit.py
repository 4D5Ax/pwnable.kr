#!/usr/bin/python3
from pwn import *
import sys
import re

#context.log_level = "debug"
regex_str = "N=(\d+) C=(\d+)"

cn = remote("pwnable.kr", "09007")
cn.recvuntil(b"- Ready? starting in 3 sec... -")
for find in range(100):
    s = cn.recvline_regex(regex_str)
    result = re.search(regex_str, s.decode("UTF-8"))
    n, c = result.groups()
    n = int(n)
    c = int(c)
    start = 0
    end = n - 1
    
    for i in range(c):
        midpoint = int((start + end) / 2)
        coins_to_test = [str(j) for j in range(start, midpoint + 1)]
        output = " ".join(coins_to_test)
        cn.sendline(output)
        weight = int(cn.recvline())
        
        if weight % 10 == 0:
            start = midpoint + 1
        else:
            end = midpoint
    
    cn.sendline(str(start))
    print(cn.recvuntil(b"Correct!").decode("UTF-8"), find)
print(cn.recvline())
print(cn.recvline())
print(cn.recvline())

